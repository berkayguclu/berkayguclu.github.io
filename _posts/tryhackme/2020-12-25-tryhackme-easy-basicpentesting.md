---
layout: post
title:  "TryHackMe/Basic Pentesting"
author: "Berkay Guclu"
lang: tr
categories: tryhackme easy
permalink: /:categories/basic-pentesting
---

[<img src="/assets/images/tryhackme/basic.png" height="199">](https://tryhackme.com/room/basicpentestingjt)

*"This is a machine that allows you to practise web app hacking and privilege escalation"* -[ashu](https://tryhackme.com/p/ashu)

Dificulty: *Easy*

1. [Scan/Enumeration](#scan/enumeration)
2. [Gain Shell](#gain-shell)
3. [Privilege Escalation](#privilege-escalation)

## [Scan/Enumeration]

Nmap taraması yaparak başlıyoruz.

{% highlight bash %}
nmap -A -oN basic.nmap <IP>
{% endhighlight %}

![basic-1](/assets/images/tryhackme/basic-1.png)

Cihazda: 80, 8009 ve 8080 portlarında web servisleri, 139 ve 445 portlarında samba servisi, 22 portunda ise SSH çalışmakta. Web sayfalarına bakmadan önce samba servisinde anonymous olarak erişebileceğimiz dosyalar olup olmadığını kontrol etmek istiyorum.

{% highlight bash %}
smbclient -L <IP>
{% endhighlight %}

"Anonymous" isminde bir paylaşım olduğunu görüyorum ve yine smbclient aracılığıyla bağlanıyorum.

{% highlight bash %}
smbclient \\\\<IP>\\Anonymous
{% endhighlight %}

![basic-2](/assets/images/tryhackme/basic-2.png)

Burada bulduğumuz staff.txt isimli dosyanın içinde birinin çalışanları burada önemli dosya paylaşımı yapılmaması için uyardığını görüyoruz. Dosyanın içinde iki adet çalışanın kullanıcı adı olabilecek isimleriyle karşılaşıyoruz: Jan ve Kay.

80 portunu kontrol edip sayfanın tadilatta olduğunu söyleyen bir notla karşılaşıyorum. Bir de yorum satırı olarak eklenmiş neyin çalıştığını öğrenmek için "dev note"u kontrol etmemizi söyleyen yazıyla. Bir kaç olası "dev note" kombinasyonunu deniyorum fakat başarıya ulaşamıyorum. Dizin taraması yapmak için gobuster'ı kullanıyorum.

{% highlight bash %}
gobuster dir -u http://<IP> -w <WORDLIST> -t 64
{% endhighlight %}

## [Gain Shell]

"/development" isminde bir dizin buluyorum. Burada dev.txt ve j.txt olmak üzere iki text dosyasıyla karşılaşıyorum. dev.txt kurulan uygulamalarla ilgili bir konuşma içerirken j.txt'de "K"in "J" için yazdığı not bulunuyor. Daha önceden Jan ve Kay isimlerini bulduğumuz için bu konuşanların yine Jan ve Kay olduklarını anlayabiliriz. Kay, Jan'in şifresini kolay bir şekilde kırabildiğini söylüyor. Bunun üzerine hydra'yı kullanarak Jan kullanıcı adına ssh üzerinden bruteforce saldırısı yapmaya karar veriyorum.

{% highlight bash %}
hydra -l jan -P <WORDLIST> <IP> ssh -t 64
{% endhighlight %}

![basic-3](/assets/images/tryhackme/basic-3.png)


## [Privilege Escalation]

Jan kullanıcısı olarak shell almayı başardık fakat kullanıcının herhangi bir sudo yetkisi bulunmuyor. Kay kullanıcısının home dizininde işimize yarayabilecek bir şey var mı diye kontrol ediyorum ve pass.bak isimli bir dosya buluyorum fakat dosya bir tek kay'ın okuyabileceği izinlerle duruyor. ".ssh" dizininde authorized_keys'e kendi public key'imi yazmayı ummuştum fakat yazma izini sadece kay'a ve kay'ın grubuna verilmiş durumda. Bunun yerine .ssh dizinindeki şifreli id_rsa'ı alıp john ile kırmayı denemeye karar veriyorum fakat önce cihazdaki SUID dosyalarını da kontrol etmek istiyorum.

{% highlight bash %}
find / -user root -perm -4000 -exec ls -ldb {} \; 2>/dev/null
{% endhighlight %}

vim.basic'in SUID dosyası olarak bulunduğunu görüyorum. Bunu kullanarak /etc/sudoers dosyasında Jan kullanıcısı için sudo yetkisi yazabiliriz.

![basic-4](/assets/images/tryhackme/basic-4.png)

Düşündüğüm gibi dosyaya yazabiliyorum ve sudo yetkisini kullanarak root kullanıcıya geçiyorum.

![basic-5](/assets/images/tryhackme/basic-5.png)
